ubuntu@ip-172-31-12-111:~/optcarrot$ RUBYOPT="-Ilib -r./tools/shim" ruby-prof bin/optcarrot -- --benchmark examples/Lan_Master.nes
fps: 0.49605795825480586
checksum: 59662
Abstract: setup_options
Abstract: print_threads
Threads [2]
Thread...
Print_thread
Measure Mode: wall_time
Thread ID: 7051680
Fiber ID: 11438140
Total: 381.340411
Sort by: self_time

 %self      total      self      wait     child     calls  name
  2.38     53.857     9.088     0.000    44.769      180   Optcarrot::CPU#run
  1.62     10.211     6.189     0.000     4.022  3515380  *Optcarrot::CPU#fetch
  1.54     11.731     5.887     0.000     5.844   838868   Optcarrot::CPU#branch
  1.35      5.139     5.139     0.000     0.000 11084918   Array#[]
  1.34      5.093     5.093     0.000     0.000 10680452   Integer#+
  1.06      7.347     4.023     0.000     3.323   816063   Optcarrot::CPU#zpg
  0.88      3.338     3.338     0.000     0.000  6881030   Integer#[]
  0.84      3.188     3.188     0.000     0.000  6727776   Integer#-
  0.74      4.366     2.824     0.000     1.542   804536   Optcarrot::CPU#_cmp
  0.58      2.209     2.209     0.000     0.000  4602226   Integer#<
  0.56      3.375     2.117     0.000     1.258   132300   Optcarrot::APU::Noise#sample
  0.55     10.330     2.091     0.000     8.239   132300   Optcarrot::APU::Mixer#sample
  0.55     15.512     2.082     0.000    13.431   856086   Optcarrot::CPU#r_op
  0.53      3.067     2.023     0.000     1.044  2282551   BasicObject#!=
  0.50      1.920     1.920     0.000     0.000  4108606   Integer#==
  0.48     13.972     1.844     0.000    12.129   809884   Optcarrot::CPU#_beq
  0.45      2.562     1.702     0.000     0.859   264600   Optcarrot::APU::Pulse#sample
  0.41     21.690     1.548     0.000    20.142       61  *Range#each
  0.40      1.543     1.543     0.000     0.000  3267275   Integer#&
  0.40      1.506     1.506     0.000     0.000  3146305   Integer#*
  0.35      1.318     1.318     0.000     0.000  2790190   Integer#|
  0.23      0.891     0.891     0.000     0.000  1843138   Integer#>=
  0.17     11.488     0.656     0.000    10.831     3893   Optcarrot::APU#proceed
  0.14      2.659     0.534     0.000     2.125    85006   Optcarrot::CPU#do_clock
  0.11      0.567     0.409     0.000     0.158   132300   Optcarrot::APU::Triangle#sample
  0.09      1.118     0.360     0.000     0.758    84291   Optcarrot::APU#clock_dmc
  0.09      1.909     0.356     0.000     1.553    85006   Optcarrot::APU#do_clock
  0.09      0.339     0.339     0.000     0.000   675732   Integer#/
  0.08      0.306     0.306     0.000     0.000   628169   Integer#>>
  0.08      0.451     0.292     0.000     0.159    99334   Array#hash
  0.07      0.441     0.252     0.000     0.189   132300   Optcarrot::APU::DMC#sample
  0.06      0.458     0.246     0.000     0.212     2934   Array#each
  0.06      0.234     0.234     0.000     0.000   498976   Array#[]=
  0.06      0.670     0.230     0.000     0.440   199853   Hash#[]
  0.06      0.222     0.222     0.000     0.000   453173   Integer#>
  0.05      0.202     0.202     0.000     0.000   408862   Integer#<=
  0.05      0.198     0.198     0.000     0.000   408863   Integer#<<
  0.05      0.278     0.197     0.000     0.082    84291   Optcarrot::APU::DMC#clock_dma
  0.05      1.351     0.183     0.000     1.168   102898   Optcarrot::APU#clock_dma
  0.04      0.159     0.159     0.000     0.000   335874   Kernel#hash
  0.04      0.158     0.158     0.000     0.000   170668   Optcarrot::CPU#current_clock
  0.04      0.151     0.151     0.000     0.000   292312   Array#<<
  0.04      0.387     0.151     0.000     0.236    14929   Optcarrot::CPU#abs_reg
  0.04      0.261     0.140     0.000     0.120    32193   Optcarrot::CPU#peek16
  0.03    294.839     0.132     0.000   294.707      180   Optcarrot::PPU#vsync
  0.03      0.138     0.128     0.000     0.009    84291   Optcarrot::APU::DMC#clock_dac
  0.03      1.031     0.110     0.000     0.922    45596   Optcarrot::CPU#read_write
  0.03      1.281     0.108     0.000     1.173    26115   Optcarrot::CPU#abs
  0.03      0.097     0.097     0.000     0.000   195002   Array#length
  0.02      0.089     0.089     0.000     0.000   181018   Integer#even?
  0.02      0.083     0.083     0.000     0.000   164717   Integer#-@
  0.02      0.081     0.081     0.000     0.000        4   Array#transpose
  0.02      3.457     0.077     0.000     3.380    22471   Optcarrot::CPU#w_op
  0.02      0.070     0.070     0.000     0.000    95232   Array#eql?
  0.02      0.137     0.064     0.000     0.073    20314   Optcarrot::CPU#imm
  0.02      1.717     0.059     0.000     1.657     4426   Optcarrot::PPU#poke_2007
  0.01      0.119     0.048     0.000     0.072     4552   Optcarrot::CPU#ind_y
  0.01      0.086     0.045     0.000     0.040     5452   Optcarrot::PPU#make_sure_invariants
  0.01      0.314     0.043     0.000     0.271    18387   Optcarrot::CPU#_bne
  0.01      3.002     0.040     0.000     2.962    17038   Optcarrot::CPU#store_mem
  0.01      0.066     0.039     0.000     0.027     6230   Optcarrot::CPU#_adc
  0.01      0.780     0.036     0.000     0.744     6509   Optcarrot::PPU#peek_2002
  0.01      0.075     0.034     0.000     0.041    17892   Optcarrot::CPU#update
  0.01      2.956     0.032     0.000     2.924    17465   Optcarrot::CPU#store
  0.01      0.051     0.032     0.000     0.020    10273   Optcarrot::CPU#push8
  0.01      0.051     0.032     0.000     0.019    10269   Optcarrot::CPU#pull8
  0.01      2.283     0.032     0.000     2.252    13327   Optcarrot::PPU#update
  0.01      2.192     0.031     0.000     2.161    13327   Optcarrot::PPU#sync
  0.01      3.747     0.028     0.000     3.718    26950   Method#[]
  0.01    296.708     0.028     0.000   296.680     5452   Optcarrot::PPU#run
  0.01      0.050     0.026     0.000     0.025     6508   Optcarrot::CPU#_bit
  0.01      0.025     0.025     0.000     0.000    25593   Optcarrot::CPU#_lda
  0.01      0.146     0.022     0.000     0.124     6392   Optcarrot::CPU#rw_op
  0.01      0.148     0.022     0.000     0.126     9421   Optcarrot::CPU#_bpl
  0.01      0.037     0.022     0.000     0.016        8   Enumerator::ArithmeticSequence#each
  0.01      0.408     0.021     0.000     0.387    14929   Optcarrot::CPU#abs_x
  0.01      0.021     0.021     0.000     0.000    21705   Optcarrot::CPU#_sta
  0.01      0.030     0.020     0.000     0.010     7346   Optcarrot::CPU#_dex
  0.00      0.044     0.019     0.000     0.025     4426   Optcarrot::PPU#update_vram_addr
  0.00      0.035     0.019     0.000     0.016     2976   Optcarrot::CPU#zpg_reg
  0.00     18.875     0.018     0.000    18.856       17  *Array#map
  0.00      0.023     0.017     0.000     0.006    11825   Optcarrot::CPU#store_zpg
  0.00      0.104     0.016     0.000     0.088     3799   Optcarrot::CPU#_jsr
  0.00      0.023     0.015     0.000     0.008     5556   Optcarrot::PPU#update_scroll_address_line
  0.00      0.023     0.015     0.000     0.008     5427   Optcarrot::CPU#_iny
  0.00      0.082     0.015     0.000     0.067     2260   Optcarrot::PPU#poke_2006
  0.00      0.019     0.015     0.000     0.004     7998   Optcarrot::CPU#_clc
  0.00      0.056     0.013     0.000     0.044     3976   Optcarrot::CPU#push16
  0.00      0.070     0.012     0.000     0.057     3797   Optcarrot::CPU#_rts
  0.00      0.939     0.012     0.000     0.927     3713   Optcarrot::APU#update
  0.00      0.054     0.011     0.000     0.043     3974   Optcarrot::CPU#pull16
  0.00      0.014     0.011     0.000     0.003     4310   Optcarrot::APU::Oscillator#active?
  0.00      0.041     0.011     0.000     0.030     2976   Optcarrot::Pads#peek_401x
  0.00      0.016     0.011     0.000     0.006     2976   Optcarrot::CPU#_ror
  0.00      0.019     0.010     0.000     0.010     2151   Optcarrot::APU::Envelope#clock
  0.00      0.014     0.009     0.000     0.005     3379   Optcarrot::CPU#_dey
  0.00      0.011     0.008     0.000     0.003     2976   Optcarrot::Pad#peek
  0.00      0.009     0.007     0.000     0.002     4700   Optcarrot::CPU#_and
  0.00      0.007     0.007     0.000     0.000    14044   Integer#^
  0.00      0.035     0.006     0.000     0.029     2151   Optcarrot::APU::Oscillator#clock_envelope
  0.00      0.007     0.006     0.000     0.002     3861   Optcarrot::CPU#_ora
  0.00      0.008     0.006     0.000     0.003     2017   Optcarrot::CPU#_inx
  0.00      0.013     0.006     0.000     0.007     1488   Optcarrot::Pad#poke
  0.00      0.017     0.005     0.000     0.012     2144   Optcarrot::CPU#_pla
  0.00      0.017     0.005     0.000     0.012     2144   Optcarrot::CPU#_pha
  0.00      0.006     0.005     0.000     0.001     2604   Optcarrot::CPU#_tax
  0.00      0.052     0.005     0.000     0.047      717   Optcarrot::APU#clock_oscillators
  0.00      0.023     0.005     0.000     0.018     2101   Optcarrot::CPU#_jmp_a
  0.00      0.008     0.005     0.000     0.003     2667   Optcarrot::CPU#_dec
  0.00      0.006     0.005     0.000     0.001     2535   Optcarrot::CPU#_txa
  0.00      0.040     0.004     0.000     0.035     2976   Optcarrot::CPU#zpg_x
  0.00      0.004     0.004     0.000     0.000     8200   Integer#coerce
  0.00      0.059     0.004     0.000     0.055      717   Optcarrot::APU#clock_frame_counter
  0.00    296.586     0.004   296.582     0.000     5452   Fiber#resume
  0.00      0.005     0.004     0.000     0.001     1024   Array#uniq!
  0.00      0.011     0.003     0.000     0.008     2160   Optcarrot::APU::Pulse#active?
  0.00      0.003     0.003     0.000     0.000     6407   Integer#~
  0.00      0.004     0.003     0.000     0.001     1567   Optcarrot::CPU#_tya
  0.00      0.004     0.003     0.000     0.001      744   Optcarrot::Pad#poll_state
  0.00      0.003     0.003     0.000     0.000        1   Array#pack
  0.00      0.004     0.003     0.000     0.001     1992   Optcarrot::APU::Envelope#update_output
  0.00      0.024     0.003     0.000     0.021      522   Optcarrot::APU::Oscillator#poke_2
  0.00     10.593     0.003     0.000    10.591      180   Optcarrot::APU#flush_sound
  0.00      0.004     0.003     0.000     0.001     1947   Optcarrot::APU::DMC#update
  0.00      0.003     0.003     0.000     0.001     1411   Optcarrot::CPU#_tay
  0.00      0.005     0.003     0.000     0.002      525   Optcarrot::APU::Envelope#write
  0.00    359.304     0.003     0.000   359.301      180   Optcarrot::NES#step
  0.00      0.008     0.003     0.000     0.006     1248   Optcarrot::APU::Triangle#active?
  0.00      0.016     0.003     0.000     0.013      744   Optcarrot::Pads#poke_4016
  0.00      0.003     0.003     0.000     0.000     2517   Optcarrot::CPU#_ldy
  0.00      0.005     0.003     0.000     0.003      296   Optcarrot::APU#clock_frame_irq
  0.00      0.008     0.003     0.000     0.005      717   Optcarrot::APU::Triangle#clock_linear_counter
  0.00      0.657     0.002     0.000     0.654      700   Optcarrot::APU::Oscillator#poke_0
  0.00      0.002     0.002     0.000     0.000     4393   BasicObject#!
  0.00      0.005     0.002     0.000     0.003      633   Optcarrot::CPU#a_op
  0.00      0.004     0.002     0.000     0.001      716   Optcarrot::APU::Pulse#clock_sweep
  0.00      0.317     0.002     0.000     0.315      126   Optcarrot::PPU#poke_2000
  0.00      0.005     0.002     0.000     0.003      354   Optcarrot::APU::Pulse#update_freq
  0.00      0.008     0.002     0.000     0.006      746   Optcarrot::CPU#_bmi
  0.00     10.598     0.002     0.000    10.596      180   Optcarrot::APU#vsync
  0.00      0.003     0.002     0.000     0.001      633   Optcarrot::CPU#_asl
  0.00      0.003     0.002     0.000     0.002      180   Optcarrot::Video#tick
  0.00      0.012     0.002     0.000     0.011      179   Optcarrot::APU::Oscillator#poke_3
  0.00      0.083     0.002     0.000     0.081     1107   Hash#[]=
  0.00      0.002     0.001     0.000     0.001      749   Optcarrot::CPU#_inc
  0.00      0.001     0.001     0.000     0.000     3072   Kernel#object_id
  0.00      0.004     0.001     0.000     0.002      243   Optcarrot::APU::DMC#do_dma
  0.00      0.009     0.001     0.000     0.008      177   Optcarrot::CPU#do_isr
  0.00      0.647     0.001     0.000     0.645      525   Optcarrot::APU#update_latency
  0.00      0.003     0.001     0.000     0.001      177   Optcarrot::CPU#flags_pack
  0.00      0.002     0.001     0.000     0.001      177   Optcarrot::CPU#flags_unpack
  0.00      0.650     0.001     0.000     0.649      350   Optcarrot::APU::Pulse#poke_0
  0.00      0.007     0.001     0.000     0.006      177   Optcarrot::CPU#_rti
  0.00      0.002     0.001     0.000     0.000      772   Optcarrot::CPU#_eor
  0.00      0.002     0.001     0.000     0.001      180   Optcarrot::CPU#vsync
  0.00      0.001     0.001     0.000     0.000     1087   Optcarrot::CPU#_ldx
  0.00      0.009     0.001     0.000     0.008       11   Hash#each_value
  0.00      0.004     0.001     0.000     0.003      348   Optcarrot::APU::Triangle#update_freq
  0.00      0.007     0.001     0.000     0.006      174   Optcarrot::APU::Noise#poke_2
  0.00      0.011     0.001     0.000     0.010      175   Optcarrot::APU::Triangle#poke_0
  0.00      0.001     0.001     0.000     0.000      256   Optcarrot::CPU#_cpy
  0.00      0.002     0.001     0.000     0.001      243   Optcarrot::CPU#dmc_dma
  0.00      0.007     0.001     0.000     0.006      179   Optcarrot::APU#update_delta
  0.00      0.002     0.001     0.000     0.001      180   Optcarrot::PPU#setup_frame
  0.00      0.001     0.001     0.000     0.000       15   Array#*
  0.00      0.001     0.001     0.000     0.000      296   Optcarrot::CPU#do_irq
  0.00      0.001     0.001     0.000     0.000     1536   Array#min
  0.00      0.001     0.001     0.000     0.000     1536   Float#floor
  0.00      0.001     0.001     0.000     0.000        2   String#bytes
  0.00      0.001     0.001     0.000     0.000      756   Optcarrot::CPU#_sty
  0.00      0.003     0.001     0.000     0.003       38   Hash#each
  0.00      0.001     0.001     0.000     0.000      358   Optcarrot::APU::Noise#clock_length_counter
  0.00      0.001     0.001     0.000     0.000     1056   Symbol#==
  0.00      0.000     0.000     0.000     0.000      543   Array#clear
  0.00      0.003     0.000     0.000     0.002      220   Optcarrot::CPU#_bcs
  0.00      0.003     0.000     0.000     0.002      210   Optcarrot::CPU#_bcc
  0.00      0.012     0.000     0.000     0.012      174   Optcarrot::APU::Triangle#poke_3
  0.00      0.000     0.000     0.000     0.000      358   Optcarrot::APU::Triangle#clock_length_counter
  0.00      0.000     0.000     0.000     0.000      180   Optcarrot::CPU#next_frame_clock=
  0.00      0.000     0.000     0.000     0.000      180   Array#concat
  0.00      0.000     0.000     0.000     0.000      179   Optcarrot::APU::LengthCounter#write
  0.00      0.000     0.000     0.000     0.000      180   <Module::Process>#clock_gettime
  0.00      0.000     0.000     0.000     0.000      541   Integer#%
  0.00      0.000     0.000     0.000     0.000      115   Optcarrot::CPU#_sec
  0.00      0.000     0.000     0.000     0.000      455   Module#method_added
  0.00      0.000     0.000     0.000     0.000        4   Array#slice!
  0.00    359.768     0.000     0.000   359.768        1   Optcarrot::NES#run
  0.00      0.000     0.000     0.000     0.000      179   Float#**
  0.00      0.642     0.000     0.000     0.642       42   Optcarrot::CPU#add_mappings
  0.00      0.000     0.000     0.000     0.000      332   Symbol#to_s
  0.00      0.000     0.000     0.000     0.000      180   Optcarrot::CPU#next_frame_clock
  0.00      0.000     0.000     0.000     0.000      180   Array#shift
  0.00      0.000     0.000     0.000     0.000      218   String#tr
  0.00      0.000     0.000     0.000     0.000        2   Integer#times
  0.00      0.000     0.000     0.000     0.000       38   Module#attr_reader
  0.00      0.000     0.000     0.000     0.000      298   String#==
  0.00      0.001     0.000     0.000     0.000        1   Optcarrot::APU#reset_mapping
  0.00      0.000     0.000     0.000     0.000      299   Kernel#is_a?
  0.00      0.000     0.000     0.000     0.000      179   Float#-
  0.00      0.004     0.000     0.000     0.003       86   <Class::Optcarrot::CPU>#op
  0.00      0.000     0.000     0.000     0.000      179   Float#/
  0.00      0.000     0.000     0.000     0.000      180   Optcarrot::Audio#tick
  0.00      0.000     0.000     0.000     0.000      218   String#size
  0.00      0.038     0.000     0.000     0.038        2   Optcarrot::PPU#reset
  0.00      0.000     0.000     0.000     0.000      180   Array#last
  0.00     18.895     0.000     0.000    18.895       16  *Kernel#require_relative
  0.00      0.000     0.000     0.000     0.000      180   Optcarrot::Input#tick
  0.00      0.000     0.000     0.000     0.000      180   Optcarrot::ROM#vsync
  0.00      0.000     0.000     0.000     0.000      212   Array#include?
  0.00      0.000     0.000     0.000     0.000       26   Optcarrot::CPU#_cpx
  0.00      0.000     0.000     0.000     0.000      180   Array#first
  0.00      0.000     0.000     0.000     0.000      178   NilClass#to_a
  0.00      0.010     0.000     0.000     0.010        7   Optcarrot::APU#poke_4015
  0.00      0.003     0.000     0.000     0.003        9   Optcarrot::Config::Parser#parse_option
  0.00      0.000     0.000     0.000     0.000       32   IO#set_encoding
  0.00      0.000     0.000     0.000     0.000       28   Optcarrot::APU::Oscillator#enable
  0.00      0.000     0.000     0.000     0.000       75   Kernel#method
  0.00      0.000     0.000     0.000     0.000       12   Optcarrot::CPU#clear_irq
  0.00      0.000     0.000     0.000     0.000      121   Method#hash
  0.00      0.000     0.000     0.000     0.000        1   <Class::IO>#binread
  0.00      0.038     0.000     0.000     0.038        3   Optcarrot::PPU#poke_2001
  0.00      0.000     0.000     0.000     0.000        8   Optcarrot::APU::Oscillator#reset
  0.00      0.000     0.000     0.000     0.000       28   Optcarrot::APU::LengthCounter#enable
  0.00      0.012     0.000     0.000     0.012        1   Optcarrot::ROM#initialize
  0.00      0.000     0.000     0.000     0.000       28   Optcarrot::APU::LengthCounter#clock
  0.00      0.001     0.000     0.000     0.001        2   Optcarrot::APU#poke_4017
  0.00      0.363     0.000     0.000     0.363        2   Optcarrot::CPU#reset
  0.00      0.000     0.000     0.000     0.000        2   IO#write
  0.00      0.001     0.000     0.000     0.001        2   Optcarrot::APU#reset
  0.00     21.246     0.000     0.000    21.245       50  *Enumerable#map
  0.00      0.000     0.000     0.000     0.000       89   String#start_with?
  0.00      0.003     0.000     0.000     0.003        1   Optcarrot::NES#dispose
  0.00    381.340     0.000     0.000   381.340        2   [global]#[no method]
  0.00      0.000     0.000     0.000     0.000        1   String#sum
  0.00      0.000     0.000     0.000     0.000        7   Optcarrot::APU::DMC#enable
  0.00      0.000     0.000     0.000     0.000        4   Optcarrot::APU::Pulse#reset
  0.00      0.000     0.000     0.000     0.000        6   Optcarrot::APU::Envelope#reset
  0.00      0.000     0.000     0.000     0.000        1   <Class::Struct>#new
  0.00      0.000     0.000     0.000     0.000        4   Optcarrot::APU::DMC#poke_0
  0.00      0.000     0.000     0.000     0.000       44   BasicObject#==
  0.00      0.000     0.000     0.000     0.000        4   Optcarrot::Config::Parser#parse_operand
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::ROM#parse_header
  0.00      0.000     0.000     0.000     0.000        8   Numeric#step
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::APU#initialize
  0.00      0.008     0.000     0.000     0.008        1   Optcarrot::Video#initialize
  0.00      0.000     0.000     0.000     0.000        3   <Module::Optcarrot::Driver>#load_each
  0.00      0.000     0.000     0.000     0.000       29   Class#inherited
  0.00      0.183     0.000     0.000     0.183        1   Optcarrot::CPU#initialize
  0.00      0.013     0.000     0.000     0.013        1   <Class::Optcarrot::ROM>#load
  0.00      0.000     0.000     0.000     0.000        2   Optcarrot::APU::DMC#reset
  0.00      0.003     0.000     0.000     0.003        1   Optcarrot::Config::Parser#initialize
  0.00      0.000     0.000     0.000     0.000       29   Method#eql?
  0.00      0.000     0.000     0.000     0.000        1   String#%
  0.00      2.469     0.000     0.000     2.469        1   Optcarrot::PPU#initialize
  0.00      0.003     0.000     0.000     0.003        9   Optcarrot::Config::Parser#find_option
  0.00      0.000     0.000     0.000     0.000        4   Optcarrot::APU::Oscillator#update_settings
  0.00      0.461     0.000     0.000     0.461        1   Optcarrot::NES#reset
  0.00      2.468     0.000     0.000     2.468        1   Optcarrot::PPU#setup_lut
  0.00      0.000     0.000     0.000     0.000        8   Optcarrot::APU::LengthCounter#reset
  0.00      0.000     0.000     0.000     0.000        9   String#=~
  0.00      0.000     0.000     0.000     0.000        2   Optcarrot::PPU#poke_2005
  0.00      0.000     0.000     0.000     0.000       20   Kernel#instance_variable_set
  0.00      0.000     0.000     0.000     0.000        2   Optcarrot::APU::Pulse#poke_1
  0.00      0.000     0.000     0.000     0.000        4   Optcarrot::APU::Oscillator#initialize
  0.00      0.000     0.000     0.000     0.000       12   BasicObject#singleton_method_added
  0.00      0.000     0.000     0.000     0.000        2   Optcarrot::APU::Pulse#initialize
  0.00      0.000     0.000     0.000     0.000        3   Optcarrot::APU::DMC#poke_1
  0.00    362.445     0.000     0.000   362.445       27  *Class#new
  0.00      0.000     0.000     0.000     0.000        2   Optcarrot::APU::Triangle#reset
  0.00      0.000     0.000     0.000     0.000        9   String#split
  0.00      0.000     0.000     0.000     0.000       10   Optcarrot::CPU#_stx
  0.00      0.000     0.000     0.000     0.000       28   Hash#key?
  0.00      0.000     0.000     0.000     0.000        2   Optcarrot::APU::Noise#reset
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Pads#reset
  0.00      0.000     0.000     0.000     0.000        2   IO#puts
  0.00      0.000     0.000     0.000     0.000        4   Optcarrot::APU::Pulse#poke_3
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Audio#initialize
  0.00      0.000     0.000     0.000     0.000        3   Optcarrot::APU::DMC#poke_2
  0.00      0.008     0.000     0.000     0.008        1   <Module::Optcarrot::Driver>#load
  0.00      0.000     0.000     0.000     0.000        3   Range#to_a
  0.00      0.000     0.000     0.000     0.000        2   Optcarrot::CPU#odd_clock?
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::PPU#nametables=
  0.00      0.000     0.000     0.000     0.000        3   Optcarrot::APU::DMC#poke_3
  0.00      0.000     0.000     0.000     0.000        3   Optcarrot::APU::Mixer#reset
  0.00      0.000     0.000     0.000     0.000        9   Symbol#===
  0.00      0.000     0.000     0.000     0.000        1   Float#to_s
  0.00      0.000     0.000     0.000     0.000        1   Fiber#initialize
  0.00      0.000     0.000     0.000     0.000        4   Optcarrot::Pad#reset
  0.00      0.000     0.000     0.000     0.000        2   Optcarrot::PPU#update_output_color
  0.00      0.000     0.000     0.000     0.000        2   Array#fill
  0.00      0.000     0.000     0.000     0.000        2   Kernel#puts
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Pads#initialize
  0.00      0.000     0.000     0.000     0.000        1   <Class::File>#basename
  0.00      0.000     0.000     0.000     0.000        1   Hash#compare_by_identity
  0.00      0.000     0.000     0.000     0.000        2   Module#append_features
  0.00      0.000     0.000     0.000     0.000        1   Module#attr_writer
  0.00      0.000     0.000     0.000     0.000        1   Module#attr_accessor
  0.00      0.000     0.000     0.000     0.000        5   Optcarrot::APU::Envelope#reset_clock
  0.00      0.000     0.000     0.000     0.000        2   Optcarrot::Pad#initialize
  0.00      0.000     0.000     0.000     0.000        1   <Class::File>#extname
  0.00      0.000     0.000     0.000     0.000        1   Hash#merge
  0.00      0.000     0.000     0.000     0.000       10   Array#empty?
  0.00      0.000     0.000     0.000     0.000        2   Kernel#dup
  0.00      0.000     0.000     0.000     0.000        3   Optcarrot::Config#debug
  0.00      0.000     0.000     0.000     0.000        7   BasicObject#initialize
  0.00      0.000     0.000     0.000     0.000        2   Module#include
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::PPU#update_enabled_flags
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::APU::Triangle#initialize
  0.00      0.000     0.000     0.000     0.000        3   Module#const_get
  0.00      0.000     0.000     0.000     0.000        3   String#to_sym
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::CPU#_sei
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::CPU#boot
  0.00      0.000     0.000     0.000     0.000        4   BasicObject#equal?
  0.00      0.000     0.000     0.000     0.000        1   Hash#initialize_copy
  0.00      0.000     0.000     0.000     0.000        2   Kernel#initialize_dup
  0.00      0.000     0.000     0.000     0.000        3   Hash#keys
  0.00      0.000     0.000     0.000     0.000        3   Enumerable#to_a
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::APU::Noise#initialize
  0.00      0.008     0.000     0.000     0.008        1   <Module::Optcarrot::Palette>#defacto_palette
  0.00      0.003     0.000     0.000     0.003        1   Optcarrot::Config#initialize
  0.00      2.676     0.000     0.000     2.676        1   Optcarrot::NES#initialize
  0.00      0.000     0.000     0.000     0.000        2   Module#module_function
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::ROM#save_battery
  0.00      0.000     0.000     0.000     0.000        1   Integer#to_s
  0.00      0.000     0.000     0.000     0.000        1   Kernel#class
  0.00      0.000     0.000     0.000     0.000        1   Array#rotate!
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::CPU#_txs
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::PPU#set_chr_mem
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::APU::DMC#initialize
  0.00      0.000     0.000     0.000     0.000        1   Kernel#Integer
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Config#info
  0.00      0.242     0.000     0.000     0.242        1   Optcarrot::ROM#reset
  0.00      0.000     0.000     0.000     0.000        1   Enumerable#all?
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::ROM#init
  0.00      0.000     0.000     0.000     0.000        1   Array#==
  0.00      0.000     0.000     0.000     0.000        2   Hash#fetch
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::APU::Mixer#initialize
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Audio#spec
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Input#initialize
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Video#init
  0.00      0.000     0.000     0.000     0.000        2   Array#unshift
  0.00      0.000     0.000     0.000     0.000        1   Module#==
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::ROM#load_battery
  0.00      0.000     0.000     0.000     0.000        1   Array#initialize_copy
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Input#init
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Audio#init
  0.00      0.008     0.000     0.000     0.008        1   Enumerable#flat_map
  0.00      0.000     0.000     0.000     0.000        1   Array#+
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Video#dispose
  0.00      0.000     0.000     0.000     0.000        1   Array#max
  0.00      0.000     0.000     0.000     0.000        1   Kernel#freeze
  0.00      0.000     0.000     0.000     0.000        1   Array#reverse
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Input#dispose
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::Audio#dispose
  0.00      0.000     0.000     0.000     0.000        2   Module#included

* indicates recursively called methods
print_thread / end
Thread...
Print_thread
Measure Mode: wall_time
Thread ID: 7051680
Fiber ID: 33874760
Total: 358.984827
Sort by: self_time

 %self      total      self      wait     child     calls  name
 17.80    289.353    63.910     0.000   225.443    86278   Numeric#step
 12.41     66.042    44.549     0.000    21.493 10997760   Optcarrot::PPU#render_pixel
  8.35     43.551    29.986     0.000    13.565 13234902   Optcarrot::PPU#wait_one_clock
  4.39     15.771    15.771     0.000     0.000 33197881   Array#[]
  3.68     19.619    13.222     0.000     6.397  2679680   Optcarrot::PPU#evaluate_sprites_odd_phase_1
  3.66     13.144    13.144     0.000     0.000 28029482   Integer#+
  2.95     34.478    10.577     0.000    23.900  4019592   Optcarrot::PPU#evaluate_sprites_odd
  2.24     11.439     8.054     0.000     3.385  3545240   Optcarrot::PPU#open_pattern
  2.16      7.758     7.758     0.000     0.000 16675332   Integer#<=
  2.07      9.337     7.420     0.000     1.917  4019591   Optcarrot::PPU#evaluate_sprites_even
  1.92      6.878     6.878     0.000     0.000  7147593   Optcarrot::PPU#update_address_line
  1.61      5.772     5.772     0.000     0.000 11864340   Integer#==
  1.58      9.046     5.668     0.000     3.379  1776976   Optcarrot::PPU#open_attr
  1.53      5.478     5.478     0.000     0.000 10997760   Array#<<
  1.48      5.297     5.297     0.000     0.000 11053831   Integer#>=
  1.47      5.290     5.290     0.000     0.000 10997760   Integer#%
  1.44      7.221     5.172     0.000     2.049  1426136   Optcarrot::PPU#scroll_clock_x
  1.25      7.246     4.493     0.000     2.753  1426136   Optcarrot::PPU#fetch_bg_pattern_1
  1.20      6.066     4.296     0.000     1.770  1863253   Optcarrot::PPU#open_name
  1.19      6.364     4.287     0.000     2.077  1339857   Optcarrot::PPU#load_tiles
  1.08      5.887     3.871     0.000     2.016  1426136   Optcarrot::PPU#fetch_name
  0.91      4.596     3.255     0.000     1.342  1426136   Optcarrot::PPU#fetch_bg_pattern_0
  0.84      3.012     3.012     0.000     0.000  1297987   Optcarrot::PPU#update_enabled_flags
  0.67      3.650     2.393     0.000     1.257  1339840   Optcarrot::PPU#evaluate_sprites_odd_phase_9
  0.63    358.985     2.250     0.000   356.735        1   Optcarrot::PPU#main_loop
  0.63      2.249     2.249     0.000     0.000  4770719   Integer#&
  0.56      2.016     2.016     0.000     0.000  1426136   Optcarrot::PPU#fetch_attr
  0.47      1.689     1.689     0.000     0.000  3410627   Integer#|
  0.42      2.235     1.510     0.000     0.725   672861   Optcarrot::PPU#wait_two_clocks
  0.38      2.077     1.370     0.000     0.708  1466738   BasicObject#!=
  0.30      1.072     1.072     0.000     0.000  2136016   Integer#<
  0.25      0.883     0.883     0.000     0.000  1660799   Array#[]=
  0.20      0.720     0.720     0.000     0.000  1339857   Optcarrot::PPU#batch_render_eight_pixels
  0.20      0.719     0.719     0.000     0.000  1339857   Array#rotate!
  0.20      0.708     0.708     0.000     0.000  1423948   Integer#*
  0.14      0.507     0.507     0.000     0.000  1005082   Integer#/
  0.14      0.503     0.503     0.000     0.000  1047993   Integer#-
  0.06      0.369     0.226     0.000     0.143    42960   Optcarrot::PPU#scroll_reset_x
  0.06      0.399     0.226     0.000     0.173    41871   Optcarrot::PPU#scroll_clock_y
  0.03      0.144     0.100     0.000     0.044    43139   Optcarrot::PPU#preload_tiles
  0.02      0.105     0.083     0.000     0.022    43139   Optcarrot::PPU#load_extended_sprites
  0.02      0.082     0.082     0.000     0.000    43135   Optcarrot::PPU#update_enabled_flags_edge
  0.02      0.098     0.064     0.000     0.034    44929   Optcarrot::PPU#wait_zero_clocks
  0.01      0.045     0.045     0.000     0.000    83914   Integer#^
  0.00     62.406     0.003    62.403     0.000     5452   <Class::Fiber>#yield
  0.00      0.003     0.001     0.000     0.002      179   Optcarrot::PPU#vblank_2
  0.00      0.001     0.001     0.000     0.000      178   Optcarrot::CPU#next_interrupt_clock
  0.00      0.001     0.001     0.000     0.000      179   Optcarrot::PPU#vblank_1
  0.00      0.002     0.000     0.000     0.001      178   Optcarrot::CPU#do_nmi
  0.00     61.061     0.000     0.000    61.060      180   Optcarrot::PPU#wait_frame
  0.00      0.000     0.000     0.000     0.000      179   Optcarrot::PPU#vblank_0
  0.00      0.000     0.000     0.000     0.000      504   Integer#===
  0.00      0.000     0.000     0.000     0.000      178   Optcarrot::CPU#next_frame_clock
  0.00      0.000     0.000     0.000     0.000       87   Optcarrot::CPU#next_frame_clock=
  0.00      0.000     0.000     0.000     0.000      174   BasicObject#!
  0.00      0.000     0.000     0.000     0.000      178   Integer#>
  0.00    358.985     0.000     0.000   358.985        1   Optcarrot::PPU#run
  0.00      0.000     0.000     0.000     0.000        1   Optcarrot::PPU#boot

* indicates recursively called methods
print_thread / end
